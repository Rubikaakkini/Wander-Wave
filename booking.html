<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WanderWave - My Bookings</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0f475e;
            --accent: #f3c48e;
            --gradient: linear-gradient(135deg, #0f475e 0%, #1c6e8c 100%);
        }

        body {
            font-family: 'Playfair Display', serif;
            background: #f8f9fa;
            margin: 0;
        }

        header {
            background: var(--gradient);
            padding: 1rem 5%;
            box-shadow: 0 4px 20px rgba(15, 71, 94, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        h1 {
            font-family: 'Montserrat', sans-serif;
            font-weight: 700;
            letter-spacing: 0.5px;
            color: white;
            margin: 0;
            font-size: 1.8rem;
        }

        nav {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        nav a {
            color: rgba(255, 255, 255, 0.9);
            padding: 0.6rem 1.2rem;
            border-radius: 30px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            text-decoration: none;
        }

        nav a.active {
            background: rgba(255, 255, 255, 0.15);
        }

        nav a:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .bookings-container {
            max-width: 1400px;
            padding: 2.5rem 5%;
            margin: 0 auto;
        }

        .page-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            color: var(--primary);
            margin-bottom: 2rem;
            position: relative;
            text-align: center;
        }

        .page-title:after {
            content: '';
            position: absolute;
            bottom: -0.75rem;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: var(--accent);
            border-radius: 2px;
        }
        /* Payment Modal Styles */
.payment-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.7);
    z-index: 1000;
    overflow-y: auto;
}

.payment-content {
    background: white;
    max-width: 500px;
    margin: 2rem auto;
    padding: 2rem;
    border-radius: 12px;
    position: relative;
    animation: modalFadeIn 0.3s ease;
}

.close-modal {
    position: absolute;
    top: 15px;
    right: 15px;
    font-size: 1.5rem;
    background: none;
    border: none;
    cursor: pointer;
    color: #666;
}

.payment-methods {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
}

.payment-method {
    flex: 1;
    padding: 0.8rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: #f9f9f9;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    transition: all 0.3s;
}

.payment-method.active {
    border-color: var(--primary);
    background: rgba(15, 71, 94, 0.1);
}

.payment-method i {
    font-size: 1.2rem;
}

.payment-option {
    margin-bottom: 1.5rem;
}

.form-row {
    display: flex;
    gap: 1rem;
}

.form-row .form-group {
    flex: 1;
}

.card-icons {
    display: flex;
    gap: 0.5rem;
    margin-top: 0.5rem;
}

.card-icons i {
    color: #666;
    font-size: 1.5rem;
}

.paypal-info {
    text-align: center;
    padding: 1.5rem;
    background: #f9f9f9;
    border-radius: 8px;
}

.paypal-logo i {
    font-size: 3rem;
    color: #003087;
    margin-top: 1rem;
}

.wallet-options {
    display: flex;
    flex-direction: column;
    gap: 0.8rem;
}

.wallet-btn {
    padding: 0.8rem;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.8rem;
    font-size: 1rem;
    transition: all 0.3s;
}

.wallet-btn:hover {
    border-color: var(--primary);
}

.terms {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin: 1.5rem 0;
}

.terms a {
    color: var(--primary);
    text-decoration: underline;
}

.submit-payment-btn {
    background: var(--primary);
    color: white;
    border: none;
    padding: 1rem;
    border-radius: 8px;
    width: 100%;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
}

.submit-payment-btn:hover {
    background: #1c6e8c;
}

@keyframes modalFadeIn {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
}
        .bookings-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
        }

        .booking-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            position: relative;
        }

        .booking-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.1);
        }

        .booking-image {
            height: 0;
            padding-top: 56.25%;
            background-size: cover;
            background-position: center;
            position: relative;
            overflow: hidden;
        }

        .booking-image:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60%;
            background: linear-gradient(transparent, rgba(0,0,0,0.5));
        }

        .booking-status {
            position: absolute;
            top: 15px;
            right: -25px;
            background: var(--accent);
            color: white;
            padding: 6px 30px;
            transform: rotate(45deg);
            font-size: 0.75rem;
            font-weight: 600;
            letter-spacing: 1px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .booking-content {
            padding: 1.5rem;
        }

        .booking-title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 1rem;
            font-weight: 600;
            line-height: 1.3;
        }

        .booking-meta {
            display: flex;
            flex-direction: column;
            gap: 1rem;
            margin-bottom: 1.2rem;
        }

        .booking-destination, .booking-duration {
            color: #666;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .booking-price {
            font-size: 1.5rem;
            color: var(--primary);
            font-family: 'Montserrat', sans-serif;
            margin: 1.2rem 0;
            font-weight: 700;
        }

        .booking-price span {
            color: #999;
            font-size: 0.9rem;
            font-weight: 400;
        }

        .remove-booking-btn {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 0.6rem;
            font-weight: 500;
            width: 100%;
            justify-content: center;
            cursor: pointer;
        }

        .remove-booking-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.2);
        }

        .payment-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }

        .payment-content {
            background: white;
            max-width: 500px;
            margin: 2rem auto;
            padding: 2rem;
            border-radius: 12px;
            position: relative;
        }

        .payment-form {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .form-input {
            padding: 0.8rem;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-family: 'Montserrat', sans-serif;
            font-size: 1rem;
        }

        .hotels-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            margin-top: 3rem;
        }

        .hotel-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.08);
            transition: transform 0.3s ease;
        }

        .hotel-card:hover {
            transform: translateY(-5px);
        }

        .hotel-image {
            height: 180px;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .hotel-rating {
            position: absolute;
            bottom: 10px;
            left: 10px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .hotel-content {
            padding: 1.2rem;
        }

        .hotel-title {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

        .hotel-location {
            color: #666;
            font-size: 0.9rem;
            margin-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .hotel-price {
            font-size: 1.2rem;
            color: var(--primary);
            font-weight: 600;
            margin: 0.8rem 0;
        }

        .hotel-price span {
            font-size: 0.9rem;
            color: #999;
            font-weight: 400;
        }

        .hotel-amenities {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
            margin-top: 0.8rem;
        }

        .amenity {
            background: #f0f0f0;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            color: #555;
        }

        .book-hotel-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            width: 100%;
            margin-top: 1rem;
            transition: background 0.3s;
        }

        .book-hotel-btn:hover {
            background: #1c6e8c;
        }

        .hotels-section {
            max-width: 1400px;
            padding: 2rem 5%;
            margin: 0 auto;
            display: none;
        }

        .hotels-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .back-to-bookings {
            background: #f0f0f0;
            color: #333;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .processing-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255,255,255,0.9);
            z-index: 1001;
            justify-content: center;
            align-items: center;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        .booking-actions {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .proceed-payment-btn {
            background: #00b894;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            justify-content: center;
            transition: all 0.3s;
        }

        .view-hotels-btn {
            background: #9b59b6;
            color: white;
            border: none;
            padding: 0.7rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.6rem;
            justify-content: center;
            transition: all 0.3s;
        }

        .view-hotels-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        .notification-toast {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: #2ecc71;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            display: none;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .booking-title {
            font-size: 1.4rem;
            margin-bottom: 1.2rem;
            color: var(--primary);
            border-bottom: 1px solid #eee;
            padding-bottom: 0.8rem;
        }
         /* Previous styles remain the same */
        
         .ai-recommendation-header {
            margin: 2rem 0 1rem;
            font-size: 1.2rem;
            color: var(--primary);
            text-align: center;
        }
        
        .ai-recommendation-header i {
            color: var(--accent);
            margin-right: 0.5rem;
        }
        
        .distance-badge {
            background: var(--accent);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }

        .booking-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }

        .booking-destination, .booking-duration {
            font-size: 1rem;
            color: #555;
        }

        .booking-price {
            font-size: 1.6rem;
            margin: 1.5rem 0;
            color: #2c3e50;
        }

        .booking-price span {
            font-size: 1rem;
            color: #7f8c8d;
        }

        .booking-actions {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .proceed-payment-btn,
        .view-hotels-btn,
        .remove-booking-btn {
            width: 100%;
            justify-content: center;
        }
        .proceed-payment-btn:hover {
            background: #00a383;
            transform: translateY(-2px);
        }

        .view-hotels-btn:hover {
            background: #8e44ad;
            transform: translateY(-2px);
        }

        .remove-booking-btn:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        footer {
            background: var(--gradient);
            padding: 1.5rem;
            margin-top: 5rem;
            color: white;
            text-align: center;
        }

        @media (max-width: 768px) {
            .page-title {
                font-size: 1.8rem;
            }
            
            .bookings-grid {
                grid-template-columns: 1fr;
            }
            
            .booking-image {
                padding-top: 65%;
            }
        }
        .no-hotels-found {
            padding: 2rem;
            text-align: center;
            background: #f8f9fa;
            border-radius: 12px;
            margin: 2rem 0;
        }

        @media (max-width: 480px) {
            .booking-meta {
                grid-template-columns: 1fr;
            }
            
            .booking-title {
                font-size: 1.2rem;
            }
            
            .booking-price {
                font-size: 1.4rem;
            }
        }
        .empty-state {
            max-width: 500px;
            margin: 0 auto;
        }

        .empty-icon {
            width: 150px;
            height: 150px;
            margin-bottom: 1.5rem;
            opacity: 0.8;
        }

        .empty-title {
            color: #2d3436;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }

        .empty-text {
            color: #636e72;
            margin-bottom: 1.5rem;
            font-size: 1rem;
        }

        .empty-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1.5rem;
        }

        .retry-btn, .contact-btn {
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: transform 0.2s ease;
        }

        .retry-btn {
            background: #4a90e2;
            color: white;
        }

        .contact-btn {
            background: #00b894;
            color: white;
        }

        .retry-btn:hover, .contact-btn:hover {
            transform: translateY(-2px);
        }
         /* Add these new styles for the map and location features */
         .location-permission {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            text-align: center;
        }
        
        .enable-location-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 1rem;
        }
        
        .hotel-map {
            height: 300px;
            width: 100%;
            border-radius: 12px;
            margin-bottom: 1.5rem;
            border: 1px solid #eee;
        }
        
        .location-badge {
            background: #4a90e2;
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.8rem;
            margin-left: 0.5rem;
        }
        
        .search-options {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .search-option-btn {
            background: #f0f0f0;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .search-option-btn.active {
            background: var(--primary);
            color: white;
        }
        
        .filter-section {
            margin-bottom: 1.5rem;
        }
        
        .filter-toggle {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            cursor: pointer;
        }
        
        .filter-content {
            display: none;
            padding: 1rem;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .filter-content.show {
            display: block;
        }
        
        .filter-group {
            margin-bottom: 1rem;
        }
        
        .filter-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
        }
        
        .price-range {
            display: flex;
            gap: 1rem;
            align-items: center;
        }
        
        .price-range input {
            width: 100px;
            padding: 0.5rem;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .amenity-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.5rem;
        }
        
        .amenity-checkbox {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        .apply-filters-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 0.6rem 1rem;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 0.5rem;
        }
        
        .current-location-info {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            color: #666;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>WanderWave</h1>
        <nav>
            <a href="index.html">Home</a>
            <a href="destinations.html">Destinations</a>
            <a href="package.html">Packages</a>
            <a href="booking.html" class="active">My Bookings <span id="booking-count"></span></a>
            <a href="blog.html">Blog</a>
            <a href="contact.html">Contact</a>
        </nav>
    </header>

    <div class="bookings-container">
        <h1 class="page-title">My Travel Bookings</h1>
        <div class="bookings-grid" id="bookings-grid"></div>
    </div>

    <div class="hotels-section" id="hotelsSection">
        <div class="hotels-header">
            <h2 id="hotelsDestination">Hotels in <span></span></h2>
            <button class="back-to-bookings" id="backToBookings">
                <i class="fas fa-arrow-left"></i>
                Back to Bookings
            </button>
        </div>
        
        <div id="locationPermission" class="location-permission" style="display: none;">
            <h3><i class="fas fa-map-marker-alt"></i> Find Hotels Near You</h3>
            <p>Enable location services to find hotels near your current location or search by destination.</p>
            <button class="enable-location-btn" id="enableLocation">
                <i class="fas fa-location-arrow"></i>
                Enable Location
            </button>
        </div>
        
        <div id="currentLocationInfo" class="current-location-info" style="display: none;">
            <i class="fas fa-map-marker-alt"></i>
            <span id="currentLocationText">Searching near your current location</span>
        </div>
        
        <div id="hotelMap" class="hotel-map"></div>
        
        <div class="search-options">
            <button class="search-option-btn active" id="searchNearMe">
                <i class="fas fa-location-arrow"></i>
                Near Me
            </button>
            <button class="search-option-btn" id="searchDestination">
                <i class="fas fa-map-marker-alt"></i>
                Destination
            </button>
        </div>
        
        <div class="filter-section">
            <div class="filter-toggle" id="filterToggle">
                <i class="fas fa-sliders-h"></i>
                <span>Filters</span>
            </div>
            <div class="filter-content" id="filterContent">
                <div class="filter-group">
                    <label>Price Range</label>
                    <div class="price-range">
                        <input type="number" id="minPrice" placeholder="Min" min="0">
                        <span>to</span>
                        <input type="number" id="maxPrice" placeholder="Max" min="0">
                    </div>
                </div>
                <div class="filter-group">
                    <label>Star Rating</label>
                    <select id="minRating" class="form-input">
                        <option value="0">Any rating</option>
                        <option value="3">3+ stars</option>
                        <option value="4" selected>4+ stars</option>
                        <option value="5">5 stars</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Amenities</label>
                    <div class="amenity-checkboxes">
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Free WiFi" checked> WiFi
                        </label>
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Pool"> Pool
                        </label>
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Restaurant"> Restaurant
                        </label>
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Breakfast"> Breakfast
                        </label>
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Parking"> Parking
                        </label>
                        <label class="amenity-checkbox">
                            <input type="checkbox" name="amenities" value="Spa"> Spa
                        </label>
                    </div>
                </div>
                <button class="apply-filters-btn" id="applyFilters">
                    Apply Filters
                </button>
            </div>
        </div>
        
        <div id="aiRecommendationsHeader" class="ai-recommendation-header" style="display: none;">
            <i class="fas fa-lightbulb"></i>
            <span>AI-Powered Recommendations</span>
        </div>
        
        
        <div class="hotels-grid" id="hotelsGrid"></div>
    </div>


    <div class="payment-modal" id="paymentModal">
        <div class="payment-content">
            <button class="close-modal" id="closeModal">&times;</button>
            <h2>Complete Your Booking</h2>
            <div class="payment-methods">
                <button class="payment-method active" data-method="card">
                    <i class="fab fa-cc-visa"></i>
                    Credit/Debit Card
                </button>
                <button class="payment-method" data-method="paypal">
                    <i class="fab fa-paypal"></i>
                    PayPal
                </button>
                <button class="payment-method" data-method="wallet">
                    <i class="fas fa-wallet"></i>
                    Digital Wallet
                </button>
            </div>
            
            <form class="payment-form" id="paymentForm">
                <!-- Card Payment (default visible) -->
                <div class="payment-option" id="cardPayment">
                    <div class="form-group">
                        <label>Card Number</label>
                        <input type="text" class="form-input" placeholder="4242 4242 4242 4242" 
                               pattern="\d{16}" title="16-digit card number" required>
                        <div class="card-icons">
                            <i class="fab fa-cc-visa"></i>
                            <i class="fab fa-cc-mastercard"></i>
                            <i class="fab fa-cc-amex"></i>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label>Expiration Date</label>
                            <input type="text" class="form-input" placeholder="MM/YY" 
                                   pattern="\d{2}/\d{2}" title="MM/YY format" required>
                        </div>
                        <div class="form-group">
                            <label>CVV</label>
                            <input type="text" class="form-input" placeholder="123" 
                                   pattern="\d{3}" title="3-digit CVV" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Cardholder Name</label>
                        <input type="text" class="form-input" placeholder="John Doe" required>
                    </div>
                </div>
                
                <!-- PayPal Payment (hidden by default) -->
                <div class="payment-option" id="paypalPayment" style="display:none;">
                    <div class="paypal-info">
                        <p>You will be redirected to PayPal to complete your payment securely.</p>
                        <div class="paypal-logo">
                            <i class="fab fa-paypal"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Digital Wallet Payment (hidden by default) -->
                <div class="payment-option" id="walletPayment" style="display:none;">
                    <div class="wallet-options">
                        <button type="button" class="wallet-btn">
                            <i class="fab fa-google-pay"></i> Google Pay
                        </button>
                        <button type="button" class="wallet-btn">
                            <i class="fab fa-apple-pay"></i> Apple Pay
                        </button>
                        <button type="button" class="wallet-btn">
                            <i class="fas fa-mobile-alt"></i> Other Wallets
                        </button>
                    </div>
                </div>
                
                <div class="form-group terms">
                    <input type="checkbox" id="acceptTerms" required>
                    <label for="acceptTerms">I agree to the <a href="#">Terms & Conditions</a></label>
                </div>
                
                <button type="submit" class="submit-payment-btn">
                    <i class="fas fa-lock"></i> Pay $<span id="paymentAmount">0.00</span>
                </button>
            </form>
        </div>
    </div>
    <div class="processing-overlay" id="processingOverlay">
        <div class="loading-spinner"></div>
    </div>

    <footer>
        <p>&copy; 2025 WanderWave. All rights reserved.</p>
    </footer>

    <div class="notification-toast" id="notificationToast"></div>

    <script>
        
        // Enhanced configuration
        const config = {
    api: {
        baseUrl: 'http://localhost:5000', // Your Flask backend URL
        endpoints: {
            nearbyHotels: '/api/nearby-hotels',
            geocode: '/api/geocode'
        }
    },
    map: {
        defaultZoom: 13,
        maxZoom: 18,
        tileLayer: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
    },
    search: {
        defaultRadius: 5000, // 5km radius
        maxResults: 20
    }
};
        // Mock hotel data for different destinations
         // Enhanced hotel data with coordinates
         const mockHotels = {
            "Paris": [
                {
                    id: 1,
                    name: "Le Grand Hotel",
                    location: "Champs-Élysées, Paris",
                    price: 250,
                    rating: 4.8,
                    image: "images/paris.jpg",
                    amenities: ["Free WiFi", "Spa", "Restaurant", "Bar"],
                    distance: "0.2 miles from city center",
                    coordinates: [48.8698, 2.3079]  // Added coordinates
                },
                // Other Paris hotels with coordinates...
            ],
            "Bali": [
                {
                    id: 10,
                    name: "Ubud Jungle Retreat",
                    location: "Ubud, Bali",
                    price: 150,
                    rating: 4.9,
                    image: "images/bali.jpg",
                    amenities: ["Free WiFi", "Pool", "Spa", "Yoga"],
                    distance: "In rice fields near Ubud",
                    coordinates: [-8.5069, 115.2625]  // Added coordinates
                },
                // Other Bali hotels with coordinates...
            ]
            // Other destinations with coordinates...
        };
        const destinationCoordinates = {
            'Paris': [48.8566, 2.3522],
            'Rome': [41.9028, 12.4964],
            'Tokyo': [35.6762, 139.6503],
            'New York': [40.7128, -74.0060],
            'Bali': [-8.4095, 115.1889]
        };
        document.addEventListener('DOMContentLoaded', function() {
            const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
            const bookingsGrid = document.getElementById('bookings-grid');
            const hotelsSection = document.getElementById('hotelsSection');
            const hotelsGrid = document.getElementById('hotelsGrid');
            const hotelsDestination = document.getElementById('hotelsDestination');
            const backToBookings = document.getElementById('backToBookings');
            const emptyState = document.createElement('div');
            const notificationToast = document.getElementById('notificationToast');
            
            emptyState.className = 'no-hotels-found';
            emptyState.innerHTML = `
                <div class="empty-state">
                    <h2 class="empty-title">No Bookings Found</h2>
                    <p class="empty-text">You haven't booked any packages yet.</p>
                    <div class="empty-actions">
                        <a href="package.html" class="retry-btn">
                            <i class="fas fa-suitcase"></i>
                            Browse Packages
                        </a>
                    </div>
                </div>
            `;

            const showNotification = (message, duration = 3000) => {
                notificationToast.textContent = message;
                notificationToast.style.display = 'block';
                setTimeout(() => {
                    notificationToast.style.display = 'none';
                }, duration);
            };

            const updateUI = () => {
                bookingsGrid.innerHTML = bookings.map(booking => `
                    <div class="booking-card" data-id="${booking.id}">
                        <div class="booking-image" style="background-image: url('${booking.image || 'default-tour-image.jpg'}')">
                            <div class="booking-status" data-status="${booking.status}">${booking.status}</div>
                        </div>
                        <div class="booking-content">
                            <h3 class="booking-title">${booking.title}</h3>
                            <div class="booking-meta">
                                <div class="booking-destination">
                                    <i class="fas fa-map-marker-alt"></i>
                                    ${booking.destination}
                                </div>
                                <div class="booking-duration">
                                    <i class="fas fa-calendar-alt"></i>
                                    ${booking.duration}
                                </div>
                            </div>
                            <div class="booking-price">
                                $${booking.price.toFixed(2)} 
                                <span>per person</span>
                            </div>
                            <div class="booking-actions">
                                <button class="proceed-payment-btn">
                                    <i class="fas fa-credit-card"></i>
                                    Proceed to Payment
                                </button>
                                <button class="view-hotels-btn">
                                    <i class="fas fa-hotel"></i>
                                    View Hotels
                                </button>
                                <button class="remove-booking-btn" data-id="${booking.id}">
                                    <i class="fas fa-trash"></i>
                                    Remove Booking
                                </button>
                            </div>
                        </div>
                    </div>
                `).join('');

                // Add event listeners
                document.querySelectorAll('.remove-booking-btn').forEach(btn => {
                    btn.addEventListener('click', handleRemoveBooking);
                });

                document.querySelectorAll('.view-hotels-btn').forEach(btn => {
                    btn.addEventListener('click', showHotels);
                });

                document.querySelectorAll('.proceed-payment-btn').forEach(btn => {
                    btn.addEventListener('click', handlePayment);
                });

                // Update booking count
                document.getElementById('booking-count').textContent = bookings.length > 0 ? `(${bookings.length})` : '';
                
                // Show/hide empty state
                if (bookings.length === 0) {
                    bookingsGrid.parentNode.insertBefore(emptyState, bookingsGrid.nextSibling);
                    bookingsGrid.style.display = 'none';
                    emptyState.style.display = 'block';
                } else {
                    emptyState.style.display = 'none';
                    bookingsGrid.style.display = 'grid';
                }
            };

            const handleRemoveBooking = (event) => {
                const bookingId = event.target.closest('.remove-booking-btn').dataset.id;
                if (confirm('Are you sure you want to remove this booking?')) {
                    const index = bookings.findIndex(b => b.id == bookingId);
                    if (index > -1) {
                        bookings.splice(index, 1);
                        localStorage.setItem('bookings', JSON.stringify(bookings));
                        updateUI();
                        showNotification('Booking removed successfully!');
                    }
                }
            };

            // In your existing book.html code, modify the showHotels function:
const showHotels = (event) => {
    const card = event.target.closest('.booking-card');
    const bookingId = card.dataset.id;
    const booking = bookings.find(b => b.id == bookingId);
    
    // Redirect to hotel.html with destination parameter
    window.location.href = `hotelmanagement.html?destination=${encodeURIComponent(booking.destination)}`;
};
            const displayHotels = (destination) => {
                hotelsDestination.querySelector('span').textContent = destination;
                
                // Get hotels for this destination (or empty array if none)
                const hotels = mockHotels[destination] || [];
                
                if (hotels.length === 0) {
                    hotelsGrid.innerHTML = `
                        <div class="no-hotels-found">
                            <h3>No hotels found for ${destination}</h3>
                            <p>We couldn't find any hotels for this destination. Please check back later.</p>
                        </div>
                    `;
                } else {
                    hotelsGrid.innerHTML = hotels.map(hotel => `
                        <div class="hotel-card">
                            <div class="hotel-image" style="background-image: url('${hotel.image}')">
                                <div class="hotel-rating">
                                    <i class="fas fa-star"></i>
                                    ${hotel.rating}
                                </div>
                            </div>
                            <div class="hotel-content">
                                <h3 class="hotel-title">${hotel.name}</h3>
                                <div class="hotel-location">
                                    <i class="fas fa-map-marker-alt"></i>
                                    ${hotel.location}
                                </div>
                                <div class="hotel-price">
                                    $${hotel.price.toFixed(2)} <span>per night</span>
                                </div>
                                <p><small>${hotel.distance}</small></p>
                                <div class="hotel-amenities">
                                    ${hotel.amenities.map(amenity => `
                                        <span class="amenity">${amenity}</span>
                                    `).join('')}
                                </div>
                                <button class="book-hotel-btn">
                                    <i class="fas fa-bookmark"></i>
                                    Book Now
                                </button>
                            </div>
                        </div>
                    `).join('');
                }
            };

            const handlePayment = (event) => {
                const card = event.target.closest('.booking-card');
                const bookingId = card.dataset.id;
                const booking = bookings.find(b => b.id == bookingId);
                
                // Show payment modal
                document.getElementById('paymentModal').style.display = 'block';
                
                // Handle form submission
                document.getElementById('paymentForm').onsubmit = (e) => {
                    e.preventDefault();
                    if (confirm('Are you sure you want to proceed with this payment?')) {
                        // Show processing
                        document.getElementById('processingOverlay').style.display = 'flex';
                        
                        // Simulate payment processing
                        setTimeout(() => {
                            document.getElementById('processingOverlay').style.display = 'none';
                            document.getElementById('paymentModal').style.display = 'none';
                            
                            // Update booking status
                            booking.status = 'Paid';
                            localStorage.setItem('bookings', JSON.stringify(bookings));
                            updateUI();
                            showNotification('Payment successful! Booking confirmed.');
                        }, 2000);
                    }
                };
            };

            // Back to bookings button
            backToBookings.addEventListener('click', () => {
                hotelsSection.style.display = 'none';
                document.querySelector('.bookings-container').style.display = 'block';
            });

            // Close modal when clicking outside
            window.addEventListener('click', (event) => {
                if (event.target === document.getElementById('paymentModal')) {
                    document.getElementById('paymentModal').style.display = 'none';
                }
            });

            // Initial setup
            updateUI();
        });
//////////rubi

        let map;
let currentLocationMarker;
let hotelMarkers = [];
let currentPosition = null;

// Initialize the Leaflet map
// Initialize the Leaflet map
function initMap(destination = 'Paris') {
    const coords = destinationCoordinates[destination] || [0, 0];

    if (map) {
        map.remove(); // Reset previous map if already initialized
    }

    map = L.map('map').setView(coords, config.map.defaultZoom);

    L.tileLayer(config.map.tileLayer, {
        maxZoom: config.map.maxZoom,
        attribution: config.map.attribution
    }).addTo(map);

    // Add current location marker (destination center)
    currentLocationMarker = L.marker(coords).addTo(map)
        .bindPopup(`<b>${destination}</b> Center`).openPopup();

    // Clear any previous hotel markers
    hotelMarkers.forEach(marker => map.removeLayer(marker));
    hotelMarkers = [];

    const hotels = mockHotels[destination] || [];
    hotels.forEach(hotel => {
        const marker = L.marker(hotel.coordinates).addTo(map)
            .bindPopup(`
                <strong>${hotel.name}</strong><br>
                ${hotel.location}<br>
                <b>Price:</b> $${hotel.price}<br>
                <b>Rating:</b> ${hotel.rating}
            `);
        hotelMarkers.push(marker);
    });
}


// Fetch hotels from your backend
async function getNearbyHotels(lat, lng, radius = config.search.defaultRadius) {
  try {
    const res = await fetch(
      `${config.api.baseUrl}${config.api.endpoints.nearbyHotels}?lat=${lat}&lng=${lng}&radius=${radius}`
    );
    if (!res.ok) throw new Error(res.statusText);
    return await res.json();
  } catch (err) {
    console.error(err);
    return [];
  }
}

// Geocode the current coords to a readable address
async function getAddressFromCoordinates(lat, lng) {
  try {
    const res = await fetch(
      `${config.api.baseUrl}${config.api.endpoints.geocode}?lat=${lat}&lng=${lng}`
    );
    if (!res.ok) throw new Error(res.statusText);
    return await res.json();
  } catch {
    return { display_name: 'your location' };
  }
}

// Render user marker + hotel markers on the map
async function updateMap(lat, lng, hotels) {
  // Clear old hotel markers
  hotelMarkers.forEach(m => map.removeLayer(m));
  hotelMarkers = [];

  // Clear old user marker
  if (currentLocationMarker) map.removeLayer(currentLocationMarker);

  // Center map
  map.setView([lat, lng], config.map.defaultZoom);

  // Add user marker
  currentLocationMarker = L.marker([lat, lng], {
    icon: L.divIcon({
      className: 'current-location-marker',
      html: `<i class="fas fa-map-marker-alt" 
                   style="color:#4a90e2;font-size:32px;"></i>`,
      iconSize: [32, 32], iconAnchor: [16, 32]
    })
  }).addTo(map);

  // Add hotel markers
  hotels.forEach(h => {
    if (!h.lat || !h.lng) return;
    const m = L.marker([h.lat, h.lng], {
      icon: L.divIcon({
        className: 'hotel-marker',
        html: `<i class="fas fa-hotel" 
                     style="color:#e74c3c;font-size:24px;"></i>`,
        iconSize: [24, 24], iconAnchor: [12, 24]
      })
    }).addTo(map);
    m.bindPopup(`
      <strong>${h.name || 'Unnamed Hotel'}</strong><br>
      ${h.address || ''}<br>
      ${h.website ? `<a href="${h.website}" target="_blank">Website</a>` : ''}
    `);
    hotelMarkers.push(m);
  });
}

// Centralized “get location + hotels + render” routine
async function locateAndShowHotels() {
  // 1. Get geolocation (if not yet obtained)
  if (!currentPosition) {
    try {
      const pos = await new Promise((resolve, reject) =>
        navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy: true })
      );
      currentPosition = {
        lat: pos.coords.latitude,
        lng: pos.coords.longitude
      };
    } catch (err) {
      alert('Unable to get your location');
      return;
    }
  }

  // 2. Show a “Searching…” overlay
  document.getElementById('processingOverlay').style.display = 'flex';

  // 3. Fetch address + hotels
  const addr = await getAddressFromCoordinates(currentPosition.lat, currentPosition.lng);
  document.getElementById('currentLocationText').textContent = `Nearby hotels to ${addr.display_name}`;

  const hotels = await getNearbyHotels(currentPosition.lat, currentPosition.lng);

  // 4. Hide overlays / show results
  document.getElementById('processingOverlay').style.display = 'none';
  document.getElementById('locationPermission').style.display = 'none';
  document.getElementById('currentLocationInfo').style.display = 'flex';

  // 5. Render map + cards
  await updateMap(currentPosition.lat, currentPosition.lng, hotels);
  displayHotels(hotels, addr.display_name);
}

// “Near Me” button simply reuses the above routine
document.getElementById('searchNearMe').addEventListener('click', () => {
  locateAndShowHotels();
});

// “Destination” also reuses it—since both use the **same** currentPosition
// (if you wanted a true “destination” search by text, you’d swap in a geocode-by-text call)
document.getElementById('searchDestination').addEventListener('click', () => {
  locateAndShowHotels();
});

// Initialize on page load


// Hotel card renderer (unchanged)
function displayHotels(hotels, locationName) {
  const grid = document.getElementById('hotelsGrid');
  if (!hotels.length) {
    grid.innerHTML = `
      <div class="no-hotels-found">
        <h3>No hotels found near ${locationName}</h3>
        <p>Please try adjusting filters or radius.</p>
      </div>
    `;
    return;
  }
  grid.innerHTML = hotels.map(h => `
    <div class="hotel-card" data-id="${h.id}">
      <div class="hotel-image"
           style="background-image:url('https://maps.googleapis.com/maps/api/streetview?size=400x300&location=${h.lat},${h.lng}&key=YOUR_API_KEY')">
        <div class="hotel-rating"><i class="fas fa-star"></i>${(Math.random()*1+4).toFixed(1)}</div>
      </div>
      <div class="hotel-content">
        <h3>${h.name||'Unnamed Hotel'}</h3>
        <p><i class="fas fa-map-marker-alt"></i>${h.address||'Address N/A'}</p>
        <p class="price">$${Math.floor(Math.random()*200+50)} <small>per night</small></p>
        <button class="book-hotel-btn">Book Now</button>
      </div>
    </div>
  `).join('');

  document.querySelectorAll('.book-hotel-btn').forEach(btn =>
    btn.addEventListener('click', e => {
      const card = e.target.closest('.hotel-card');
      const hotel = hotels.find(h => h.id == card.dataset.id);
      if (hotel) bookHotel(hotel, locationName);
    })
  );
}

// Placeholder booking logic
function bookHotel(hotel, locationName) {
  alert(`Booking: ${hotel.name} at ${locationName}`);
}
// Payment System Enhancements
document.addEventListener('DOMContentLoaded', function() {
    // Payment method switching
    const paymentMethods = document.querySelectorAll('.payment-method');
    const paymentOptions = document.querySelectorAll('.payment-option');
    
    paymentMethods.forEach(method => {
        method.addEventListener('click', () => {
            // Remove active class from all methods
            paymentMethods.forEach(m => m.classList.remove('active'));
            // Add active class to clicked method
            method.classList.add('active');
            
            // Hide all payment options
            paymentOptions.forEach(option => option.style.display = 'none');
            
            // Show selected payment option
            const methodName = method.dataset.method;
            document.getElementById(`${methodName}Payment`).style.display = 'block';
        });
    });
    
    // Close modal
    document.getElementById('closeModal').addEventListener('click', () => {
        document.getElementById('paymentModal').style.display = 'none';
    });
    
    // Handle payment form submission
    document.getElementById('paymentForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const processingOverlay = document.getElementById('processingOverlay');
        processingOverlay.style.display = 'flex';
        
        try {
            // Simulate payment processing
            await new Promise(resolve => setTimeout(resolve, 2000));
            
            // Get the active payment method
            const activeMethod = document.querySelector('.payment-method.active').dataset.method;
            
            // Process payment based on method
            let paymentSuccess = false;
            
            switch(activeMethod) {
                case 'card':
                    paymentSuccess = await processCardPayment();
                    break;
                case 'paypal':
                    paymentSuccess = await processPayPalPayment();
                    break;
                case 'wallet':
                    paymentSuccess = await processWalletPayment();
                    break;
            }
            
            if (paymentSuccess) {
                // Update booking status
                const bookingId = document.getElementById('paymentModal').dataset.bookingId;
                const bookings = JSON.parse(localStorage.getItem('bookings')) || [];
                const booking = bookings.find(b => b.id == bookingId);
                
                if (booking) {
                    booking.status = 'Paid';
                    booking.paymentDate = new Date().toISOString();
                    localStorage.setItem('bookings', JSON.stringify(bookings));
                    updateUI();
                }
                
                showNotification('Payment successful! Your booking is confirmed.', 5000);
                document.getElementById('paymentModal').style.display = 'none';
            } else {
                showNotification('Payment failed. Please try another method.', 5000, 'error');
            }
        } catch (error) {
            console.error('Payment error:', error);
            showNotification('An error occurred during payment processing.', 5000, 'error');
        } finally {
            processingOverlay.style.display = 'none';
        }
    });
    
    // Update payment amount when modal opens
      // Update payment amount when modal opens
      document.querySelectorAll('.proceed-payment-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            const card = this.closest('.booking-card');
            const bookingId = card.dataset.id;
            const booking = bookings.find(b => b.id == bookingId);
            
            if (booking) {
                document.getElementById('paymentModal').dataset.bookingId = bookingId;
                document.getElementById('paymentAmount').textContent = booking.price.toFixed(2);
                document.getElementById('paymentModal').style.display = 'block';
            }
        });
    });

});

// Mock payment processors
async function processCardPayment() {
    // In a real app, you would integrate with Stripe or other payment processor
    return new Promise(resolve => {
        setTimeout(() => {
            // Simulate 90% success rate for demo
            resolve(Math.random() < 0.9);
        }, 1500);
    });
}

async function processPayPalPayment() {
    // In a real app, redirect to PayPal or use their API
    return new Promise(resolve => {
        setTimeout(() => {
            // Simulate 95% success rate for demo
            resolve(Math.random() < 0.95);
        }, 2000);
    });
}

async function processWalletPayment() {
    // In a real app, integrate with Google Pay/Apple Pay APIs
    return new Promise(resolve => {
        setTimeout(() => {
            // Simulate 85% success rate for demo
            resolve(Math.random() < 0.85);
        }, 1000);
    });
}

// Enhanced notification system
function showNotification(message, duration = 3000, type = 'success') {
    const toast = document.getElementById('notificationToast');
    toast.textContent = message;
    toast.className = 'notification-toast';
    toast.classList.add(type);
    toast.style.display = 'block';
    
    setTimeout(() => {
        toast.style.display = 'none';
    }, duration);
}
// In your booking card generation code:
const bookingImage = new Image();
bookingImage.src = booking.image || 'images/default-booking.jpg';
bookingImage.onload = function() {
    // Image loaded successfully
    card.querySelector('.booking-image').style.backgroundImage = `url('${this.src}')`;
};
bookingImage.onerror = function() {
    // Image failed to load
    card.querySelector('.booking-image').style.backgroundImage = 'url("images/default-booking.jpg")';
};


 </script>
</body>
</html>